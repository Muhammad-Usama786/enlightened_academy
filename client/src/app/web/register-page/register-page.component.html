<!-- <app-nav-bar></app-nav-bar> -->
<div class="container-fluid">
  <mat-card class="stepper-card">
    <mat-card-header>
      <mat-card-title>Registration</mat-card-title>
      <mat-card-subtitle>Student Registration Form</mat-card-subtitle>
    </mat-card-header>

    <div class="stepper-container">
      <mat-vertical-stepper color="primary" class="stepper" [linear]="true">
        <mat-step label="Student Information" [stepControl]="studentDataForm">
          <div class="form-container">
            <form [formGroup]="studentDataForm" (submit)="submitForm()">
              <div class="list-group-item">
                <div class="form-row">
                  <mat-form-field class="border-#a0ce4e" appearance="outline">
                    <!-- <mat-label>First Name </mat-label> -->
                    <input
                      placeholder="First Name"
                      matInput
                      type="text"
                      formControlName="firstName"
                      required
                      name="firstName"
                    />
                    <!-- <mat-icon matSuffix>sentiment_very_satisfied</mat-icon> -->
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['firstName'].hasError(
                          'required'
                        )
                      "
                    >
                      Product Code is
                      <strong>required</strong>
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field class="border-#a0ce4e" appearance="outline">
                    <!-- <mat-label>Last Name </mat-label> -->
                    <input
                      placeholder="Last Name"
                      matInput
                      type="text"
                      formControlName="lastName"
                      required
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['lastName'].hasError(
                          'required'
                        )
                      "
                      >Last Name is required</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> CNIC </mat-label> -->
                    <input
                      placeholder="CNIC"
                      matInput
                      type="text"
                      formControlName="CNIC"
                      required
                      pattern="^\d{13}$"
                      (change)="cnicDuplicate($event)"
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['CNIC'].hasError('required')
                      "
                      >CNIC is required</mat-error
                    >
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['CNIC'].hasError('pattern')
                      "
                      >Invalid CNIC (must be 13 digits)</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> Father's CNIC </mat-label> -->
                    <input
                      placeholder="Father's CNIC "
                      matInput
                      type="text"
                      formControlName="fathersCNIC"
                      required
                      pattern="^\d{13}$"
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['fathersCNIC'].hasError(
                          'required'
                        )
                      "
                      >Father's CNIC is required</mat-error
                    >
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['fathersCNIC'].hasError(
                          'pattern'
                        )
                      "
                      >Invalid Father's CNIC (must be 13 digits)</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> Email </mat-label> -->
                    <input
                      matInput
                      placeholder="Email"
                      type="email"
                      formControlName="email"
                      required
                      (change)="emailDuplicate($event)"
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['email'].hasError('required')
                      "
                      >Email is required</mat-error
                    >
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['email'].hasError('email')
                      "
                      >Invalid email</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> Phone Number </mat-label> -->
                    <input
                      matInput
                      placeholder="Phone Number"
                      type="tel"
                      formControlName="phone"
                      required
                      pattern="^0\d{10}$"
                      (change)="phoneDuplicate($event)"
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['phone'].hasError('required')
                      "
                      >Phone Number is required</mat-error
                    >
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['phone'].hasError('pattern')
                      "
                      >Invalid Phone Number (must start with 0, 11
                      digits)</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> Date of Birth </mat-label> -->
                    <input
                      placeholder="Date of Birth"
                      matInput
                      type="date"
                      formControlName="dateOfBirth"
                      required
                    />
                    <mat-error
                      *ngIf="
                        studentDataForm.controls['dateOfBirth'].hasError(
                          'required'
                        )
                      "
                      >Date of Birth is required</mat-error
                    >
                  </mat-form-field>

                  <mat-form-field appearance="outline">
                    <!-- <mat-label> Address </mat-label> -->

                    <input
                      matInput
                      placeholder="Address"
                      type="text"
                      formControlName="address"
                      required
                    />

                    <mat-error
                      *ngIf="
                        studentDataForm.controls['address'].hasError('required')
                      "
                      >Address is required</mat-error
                    >
                  </mat-form-field>
                  <fieldset>
                    <legend>
                        <label style="font-size: 20px;" [attr.for]="'gender'">Gender</label>
                    </legend>
                    <div class="row">
                        <mat-radio-group formControlName="gender" aria-label="Select an option">
                            <mat-radio-button color="primary" value="M">Male</mat-radio-button>
                            <mat-radio-button color="primary" value="F">Female</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </fieldset>   
                  <!-- <mat-label>Gender</mat-label> -->
                  <!-- <mat-radio-group formControlName="gender">
                  
                    <mat-radio-button color="primary" value="M"
                      >Male</mat-radio-button
                    >
                    <mat-radio-button color="primary" value="F"
                      >Female</mat-radio-button
                    >
                  </mat-radio-group> -->
                 
           
                </div>
              </div>
            </form>
          </div>
          <!-- <button mat-button matStepperNext class="navBtn">Next</button> -->
          <button matStepperNext class="rounded-full rounded-full custom-btn">
            Next
          </button>
          <!-- <button (click)="resetCNIC()">Reset CNIC</button> -->
        </mat-step>
        <mat-step label="Course Registration" [stepControl]="courseForm">
          <div class="list">
            <div *ngFor="let course of availableCourses" class="course-item">
              <mat-checkbox
                color="primary"
                [(ngModel)]="course.checked"
                class="checkbox"
                (change)="updateCourseSelection()"
              >
                {{ course.name }} - {{ course.fee }} RS
              </mat-checkbox>
            </div>
            <mat-error *ngIf="!isCourseSelected()"
              >Please select at least one course</mat-error
            >
          </div>
          <ng-template matStepIcon> </ng-template>
          <div class="stepper-buttons">
            <button
              matStepperPrevious
              class="rounded-full rounded-full custom-btn mx-0.5"
            >
              Back
            </button>
            <button
              matStepperNext
              [disabled]="!isCourseSelected()"
              class="rounded-full rounded-full custom-btn"
            >
              Next
            </button>
            <!-- <button
              mat-button
       
              class="navBtn"
            >
              Next
            </button> -->
          </div>
        </mat-step>

        <mat-step>
          <ng-template matStepLabel> Confirm </ng-template>
          <div class="confirm-container">
            <div class="centered-card">
              <mat-card class="confirmation-tile">
                <mat-card-title>
                  Are you sure you want to proceed with the Registration?
                </mat-card-title>
                <mat-card-actions>
                  <button
                    (click)="postEnrollment()"
                    class="rounded-full rounded-full custom-btn mx-1"
                  >
                    Yes
                  </button>
                  <button
                    class="rounded-full rounded-full custom-btn mx-1"
                    matStepperPrevious
                  >
                    No
                  </button>
                </mat-card-actions>
              </mat-card>
            </div>
          </div>
        </mat-step>
      </mat-vertical-stepper>
    </div>
  </mat-card>
</div>
<ng-container *ngIf="loading">
  <app-loader></app-loader>
</ng-container>
